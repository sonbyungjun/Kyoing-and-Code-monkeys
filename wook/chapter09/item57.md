# 지역변수의 범위를 최소화하라

## 핵심 요약

### 유용한 방법

* 가장 처음 쓰일 때 선언 하기

  1.  미리 선언부터 해두면 가독성이 떨어진다.

  1. 변수를 실제로 사용하는 시점엔 타입과 초깃값이 기억나지 않을 수도 있다.

  1. 쓰이는 범위보다 너무 앞서 선언하거나, 다 쓴 뒤에도 여전히 살아 있게 되기 쉽다.

* 선언과 동시에 초기화해야 한다.

  1. 초기화에 필요한 정보가 충분하지 않다면 충분해질 때까지 선언을 미뤄야 한다.

  1. `try-catch` 문은 이 규칙에서 예외이다. (그렇지 않으면 예외가 블록을 넘어 메서드에까지 전파된다)

  1. `try`블록 바깥에서도 사용해야 한다면 (비록 초기화는 못해도) `try`블록 앞에서 선언해야 한다.

* 메서드를 작게 유지하고 한 가지 기능에 집중하는 것

  1. 한 메서드에서 여러가지 기능을 처리한다면 그중한 기능과만 관련된 지역변수라도 다른 기능을 수행하는 코드에서 접근할 수 있다. 해결방법은 메서드를 기능별로 쪼개는 것.

### 반복문에서의 지역변수 선언

* 컬렉션이나 배열을 순회하는 권장 관용구

  ```java
  for (Element e : c) {
    ... // e로 무언가를 함.
  }
  ```

  > 반복자를 사용해야 하는 상황이면(remove메서드를 쓴다든가) 전통적인 for문을 쓰는 것이 낫다.

* 반복자가 필요할 때의 관용구

  ```java
  for (Iterator<Element> i = c.iterator(); i.hasNext();) {
    Element e = i.next();
    ... // e와 i로 무언가를 한다.
  }
  ```

  > 이렇게 사용하는 것이 `while`문을 사용하는 것보다 더 나은 이유도 있음.

* 버그를 발생 시킬 수도 있는 상황

  ```java
  Iterator<Element> i = c.iterator();
  while (i.hasNext()) {
    doShomething(i.next());
  }

  ...

  Iterator<Element> i2 = c2.iterator();
  while (i.hasNext()) {  // 버그!
    doShomething(i.next());
  }
  ```

  > 새로운 반복 변수 i2를 초기화 했지만, 실수로 이전 `while`문에서 쓴 i를 다시 씀. 불행히도 i의 유효범위는 끝나지 않았으므로, 이 코드는 컴파일도 잘 되고 실행 시 예외도 던지지 않음. 하지만 두 번째 `while`문은 c2를 순회하지 않고 곧장 끝나버려 c2가 비어있다고 착각하게 만듬.

* 전통적인 `for`문 에서의 상황

  ```java
  for (Iterator<Element> i = c.iterator(); i.hasNext();) {
    Element e = i.next();
    ... // e와 i로 무언가를 한다.
  }

  ...

  // "i를 찾을 수 없다"는 컴파일 오류를 낸다.
  for (Iterator<Element> i2 = c2.iterator(); i.hasNext();) {
    Element e2 = i.next();
    ... // e와 i로 무언가를 한다.
  }
  ```

  > 똑같은 변수명을 사용해도 아무런 영향을 주지 않음. `while`문도 보다 짧아서 가독성도 좋음.